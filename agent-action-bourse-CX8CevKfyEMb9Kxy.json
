{"createdAt":"2025-07-04T14:27:57.789Z","updatedAt":"2025-07-16T12:47:36.000Z","id":"CX8CevKfyEMb9Kxy","name":"Agent Action bourse","active":true,"isArchived":false,"nodes":[{"parameters":{"assignments":{"assignments":[{"id":"6aba6a49-e292-486e-9982-2746c28f9579","name":"cours_close","value":"={{ $json.close }}","type":"string"},{"id":"68730963-b375-4661-9e9d-5168e5964786","name":"date_cours","value":"={{ $json.latestDate }}","type":"string"},{"id":"348922f2-536b-4469-90a8-26e97921fe88","name":"cours_open","value":"={{ $json.open }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[80,-80],"id":"0b1ccb59-90e1-4769-809a-fff3039176cc","name":"Edit Fields"},{"parameters":{"jsCode":"const timeSeries = $json[\"Time Series (60min)\"];\nconst dates = Object.keys(timeSeries);\ndates.sort().reverse();\n\nconst latestDate = dates[0];\nconst latestData = timeSeries[latestDate];\n\nreturn [\n  {\n    json: {\n      latestDate,\n      close: Number(latestData[\"4. close\"]),\n      open: Number(latestData[\"1. open\"]),\n      high: Number(latestData[\"2. high\"]),\n      low: Number(latestData[\"3. low\"]),\n      volume: Number(latestData[\"5. volume\"]),\n    }\n  }\n];\n\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-120,-80],"id":"83cc5c7e-362d-4131-b8be-ba4576978253","name":"Code"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Feuille 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"date_cours":"={{ $json.date_cours }}","cours_close":"={{ $json.cours_close }}","cours_open":"={{ $json.cours_open }}","cours_high":"={{ $('Code').item.json.high }}","cours_low":"={{ $('Code').item.json.low }}","volume":"={{ $('Code').item.json.volume }}","symbole ":"GOOGLE"},"matchingColumns":["symbole "],"schema":[{"id":"date_cours","displayName":"date_cours","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"symbole ","displayName":"symbole ","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"cours_close","displayName":"cours_close","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_open","displayName":"cours_open","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_high","displayName":"cours_high","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_low","displayName":"cours_low","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"volume","displayName":"volume","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[340,-80],"id":"f38e416c-faa2-4244-ad2c-350db139b7c8","name":"Google Sheets","credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"jsCode":"// Récupère toutes les lignes du Google Sheets\nconst lignes = items.map(item => item.json);\n\n// Trie les lignes par date croissante (adapte le champ si besoin)\nlignes.sort((a, b) => a.date_cours > b.date_cours ? 1 : -1);\n\n// Prend les 2 dernières (plus récentes)\nconst l1 = lignes[lignes.length-1];\nconst l2 = lignes[lignes.length-2];\n\nif (!l1 || !l2) {\n  return [{ json: { error: \"Pas assez de données\" }}];\n}\n\nconst cours_today = Number(l1.cours_close);\nconst cours_yesterday = Number(l2.cours_close);\nconst variation = ((cours_today - cours_yesterday) / cours_yesterday) * 100;\n\nlet commentaire = \"\";\nif (variation > 1) commentaire = \"📈 Forte hausse\";\nelse if (variation < -1) commentaire = \"📉 Baisse notable\";\nelse commentaire = \"➖ Stable\";\n\nreturn [{\n  json: {\n    date_today: l1.date_cours,\n    cours_today,\n    cours_yesterday,\n    variation: variation.toFixed(2),\n    commentaire\n  }\n}];\n"},"id":"1f80b996-10a2-44e2-ac22-391b4520f16f","name":"Préparer Rapport","type":"n8n-nodes-base.code","typeVersion":1,"position":[980,-80]},{"parameters":{"chatId":"7562186427","text":"={{ $json.text }}","additionalFields":{}},"id":"e2bc52e6-c54b-4df0-a1ee-b70bcaf5b477","name":"Telegram - Rapport","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1620,260],"webhookId":"917d505b-d198-4384-a13e-09d57b3a5d9b","credentials":{"telegramApi":{"id":"3zWMDdIXgK9GGJJG","name":"Telegram account 2"}}},{"parameters":{"triggerTimes":{"item":[{"hour":20,"minute":30}]}},"id":"71abe170-9b32-4240-895b-f971507dcc78","name":"Schedule Trigger1","type":"n8n-nodes-base.cron","typeVersion":1,"position":[580,-80]},{"parameters":{"triggerTimes":{"item":[{"hour":15}]}},"id":"7876980d-d852-4cd1-a01c-fc43e260373f","name":"Schedule Trigger2","type":"n8n-nodes-base.cron","typeVersion":1,"position":[-560,-80]},{"parameters":{"content":"## Enregistrement actions","height":880,"width":1160},"type":"n8n-nodes-base.stickyNote","position":[-640,-140],"typeVersion":1,"id":"cb61fcef-488f-40eb-a968-4cef8222fb13","name":"Sticky Note"},{"parameters":{"content":"## Envoie rapport sur telegram","height":880,"width":1240},"type":"n8n-nodes-base.stickyNote","position":[540,-140],"typeVersion":1,"id":"39384cea-f0f7-4fd6-82a5-76f0b52f5219","name":"Sticky Note1"},{"parameters":{"url":"https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=MSFT&interval=60min&apikey=5A81GNYOATM2RWPB","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-340,80],"id":"6634fbf9-34b9-4085-9c6b-adaedd23b6d6","name":"Microsoft"},{"parameters":{"url":"https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=GOOGL&interval=60min&apikey=5A81GNYOATM2RWPB","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-340,-80],"id":"5d38e1df-33d9-48ee-beea-6a901e80ad47","name":"Google"},{"parameters":{"url":"https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=AAPL&interval=60min&apikey=5A81GNYOATM2RWPB","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-340,240],"id":"89aaf0ba-4889-464c-9244-e05a6a352363","name":"Apple"},{"parameters":{"url":"https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=AMZN&interval=60min&apikey=5A81GNYOATM2RWPB","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-340,400],"id":"5103af31-19bb-4c64-b274-0e8da65144b8","name":"Amazon"},{"parameters":{"url":"https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=NVDA&interval=60min&apikey=5A81GNYOATM2RWPB","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-340,560],"id":"925a0ef6-41eb-4e6c-b3a1-3c94938cac6c","name":"Nvidia"},{"parameters":{"jsCode":"const timeSeries = $json[\"Time Series (60min)\"];\nconst dates = Object.keys(timeSeries);\ndates.sort().reverse();\n\nconst latestDate = dates[0];\nconst latestData = timeSeries[latestDate];\n\nreturn [\n  {\n    json: {\n      latestDate,\n      close: Number(latestData[\"4. close\"]),\n      open: Number(latestData[\"1. open\"]),\n      high: Number(latestData[\"2. high\"]),\n      low: Number(latestData[\"3. low\"]),\n      volume: Number(latestData[\"5. volume\"]),\n    }\n  }\n];\n\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-120,80],"id":"75b540fa-c1bf-4627-8967-4089910fb12e","name":"Code1"},{"parameters":{"jsCode":"const timeSeries = $json[\"Time Series (60min)\"];\nconst dates = Object.keys(timeSeries);\ndates.sort().reverse();\n\nconst latestDate = dates[0];\nconst latestData = timeSeries[latestDate];\n\nreturn [\n  {\n    json: {\n      latestDate,\n      close: Number(latestData[\"4. close\"]),\n      open: Number(latestData[\"1. open\"]),\n      high: Number(latestData[\"2. high\"]),\n      low: Number(latestData[\"3. low\"]),\n      volume: Number(latestData[\"5. volume\"]),\n    }\n  }\n];\n\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-120,240],"id":"8d375e41-da69-4d5d-9320-d36182bd129a","name":"Code2"},{"parameters":{"jsCode":"const timeSeries = $json[\"Time Series (60min)\"];\nconst dates = Object.keys(timeSeries);\ndates.sort().reverse();\n\nconst latestDate = dates[0];\nconst latestData = timeSeries[latestDate];\n\nreturn [\n  {\n    json: {\n      latestDate,\n      close: Number(latestData[\"4. close\"]),\n      open: Number(latestData[\"1. open\"]),\n      high: Number(latestData[\"2. high\"]),\n      low: Number(latestData[\"3. low\"]),\n      volume: Number(latestData[\"5. volume\"]),\n    }\n  }\n];\n\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-120,400],"id":"e9b9f841-fe88-4123-8463-f348c08f8db3","name":"Code3"},{"parameters":{"jsCode":"const timeSeries = $json[\"Time Series (60min)\"];\nconst dates = Object.keys(timeSeries);\ndates.sort().reverse();\n\nconst latestDate = dates[0];\nconst latestData = timeSeries[latestDate];\n\nreturn [\n  {\n    json: {\n      latestDate,\n      close: Number(latestData[\"4. close\"]),\n      open: Number(latestData[\"1. open\"]),\n      high: Number(latestData[\"2. high\"]),\n      low: Number(latestData[\"3. low\"]),\n      volume: Number(latestData[\"5. volume\"]),\n    }\n  }\n];\n\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-120,560],"id":"8c438243-3e2d-4358-b060-9c410620fc23","name":"Code4"},{"parameters":{"assignments":{"assignments":[{"id":"6aba6a49-e292-486e-9982-2746c28f9579","name":"cours_close","value":"={{ $json.close }}","type":"string"},{"id":"68730963-b375-4661-9e9d-5168e5964786","name":"date_cours","value":"={{ $json.latestDate }}","type":"string"},{"id":"348922f2-536b-4469-90a8-26e97921fe88","name":"cours_open","value":"={{ $json.open }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[80,80],"id":"b6c4ea60-189a-4536-8306-82789b2f9dbd","name":"Edit Fields1"},{"parameters":{"assignments":{"assignments":[{"id":"6aba6a49-e292-486e-9982-2746c28f9579","name":"cours_close","value":"={{ $json.close }}","type":"string"},{"id":"68730963-b375-4661-9e9d-5168e5964786","name":"date_cours","value":"={{ $json.latestDate }}","type":"string"},{"id":"348922f2-536b-4469-90a8-26e97921fe88","name":"cours_open","value":"={{ $json.open }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[80,240],"id":"9ef9c240-962c-4b20-afbb-7fbe0fe67851","name":"Edit Fields2"},{"parameters":{"assignments":{"assignments":[{"id":"6aba6a49-e292-486e-9982-2746c28f9579","name":"cours_close","value":"={{ $json.close }}","type":"string"},{"id":"68730963-b375-4661-9e9d-5168e5964786","name":"date_cours","value":"={{ $json.latestDate }}","type":"string"},{"id":"348922f2-536b-4469-90a8-26e97921fe88","name":"cours_open","value":"={{ $json.open }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[80,400],"id":"f2804f65-91b5-4841-bebc-581d303d79b0","name":"Edit Fields3"},{"parameters":{"assignments":{"assignments":[{"id":"6aba6a49-e292-486e-9982-2746c28f9579","name":"cours_close","value":"={{ $json.close }}","type":"string"},{"id":"68730963-b375-4661-9e9d-5168e5964786","name":"date_cours","value":"={{ $json.latestDate }}","type":"string"},{"id":"348922f2-536b-4469-90a8-26e97921fe88","name":"cours_open","value":"={{ $json.open }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[80,560],"id":"86bb3ea3-3f0a-40bf-8217-9e1d5d4f3e39","name":"Edit Fields4"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":1581815256,"mode":"list","cachedResultName":"MICROSOFT","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=1581815256"},"columns":{"mappingMode":"defineBelow","value":{"date_cours":"={{ $json.date_cours }}","cours_close":"={{ $json.cours_close }}","cours_open":"={{ $json.cours_open }}","cours_high":"={{ $('Code1').item.json.high }}","cours_low":"={{ $('Code1').item.json.low }}","volume":"={{ $('Code1').item.json.volume }}","symbole ":"Microsoft"},"matchingColumns":["symbole "],"schema":[{"id":"date_cours","displayName":"date_cours","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"symbole ","displayName":"symbole ","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"cours_close","displayName":"cours_close","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_open","displayName":"cours_open","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_high","displayName":"cours_high","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_low","displayName":"cours_low","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"volume","displayName":"volume","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[340,80],"id":"154bbc99-6580-4623-856a-79b5c45429c0","name":"Google Sheets1","credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":424556455,"mode":"list","cachedResultName":"APPLE","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=424556455"},"columns":{"mappingMode":"defineBelow","value":{"date_cours":"={{ $json.date_cours }}","cours_close":"={{ $json.cours_close }}","cours_open":"={{ $json.cours_open }}","cours_high":"={{ $('Code2').item.json.high }}","cours_low":"={{ $('Code2').item.json.low }}","volume":"={{ $('Code2').item.json.volume }}","symbole ":"Apple"},"matchingColumns":["symbole "],"schema":[{"id":"date_cours","displayName":"date_cours","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"symbole ","displayName":"symbole ","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"cours_close","displayName":"cours_close","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_open","displayName":"cours_open","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_high","displayName":"cours_high","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_low","displayName":"cours_low","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"volume","displayName":"volume","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[340,240],"id":"2f97ca14-8ef1-40f7-be65-7a72b96032d1","name":"Google Sheets2","credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":1181166958,"mode":"list","cachedResultName":"AMAZON","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=1181166958"},"columns":{"mappingMode":"defineBelow","value":{"date_cours":"={{ $json.date_cours }}","cours_close":"={{ $json.cours_close }}","cours_open":"={{ $json.cours_open }}","cours_high":"={{ $('Code3').item.json.high }}","cours_low":"={{ $('Code3').item.json.low }}","volume":"={{ $('Code3').item.json.volume }}","symbole ":"Amazon"},"matchingColumns":["symbole "],"schema":[{"id":"date_cours","displayName":"date_cours","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"symbole ","displayName":"symbole ","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"cours_close","displayName":"cours_close","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_open","displayName":"cours_open","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_high","displayName":"cours_high","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_low","displayName":"cours_low","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"volume","displayName":"volume","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[340,400],"id":"22324b7f-9f9d-4b37-83d8-07cf579db0b1","name":"Google Sheets3","credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":1454952956,"mode":"list","cachedResultName":"NVIDIA","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=1454952956"},"columns":{"mappingMode":"defineBelow","value":{"date_cours":"={{ $json.date_cours }}","cours_close":"={{ $json.cours_close }}","cours_open":"={{ $json.cours_open }}","cours_high":"={{ $('Code4').item.json.high }}","cours_low":"={{ $('Code4').item.json.low }}","volume":"={{ $('Code4').item.json.volume }}","symbole ":"Nvidia"},"matchingColumns":["symbole "],"schema":[{"id":"date_cours","displayName":"date_cours","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"symbole ","displayName":"symbole ","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"cours_close","displayName":"cours_close","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_open","displayName":"cours_open","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_high","displayName":"cours_high","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"cours_low","displayName":"cours_low","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"volume","displayName":"volume","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[340,560],"id":"a5a0dec9-0695-44a1-99d4-5c72e8098e2b","name":"Google Sheets4","credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"GOOGLE","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=0"},"options":{}},"id":"be6cef28-71ea-4646-919b-5794e805a2bb","name":"Read google","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[780,-80],"credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":1581815256,"mode":"list","cachedResultName":"MICROSOFT","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=1581815256"},"options":{}},"id":"30d5b023-ce61-401b-be3c-1ca2ba8f4572","name":"Read Microsoft","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[780,80],"credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":424556455,"mode":"list","cachedResultName":"APPLE","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=424556455"},"options":{}},"id":"c7901501-b124-4cbb-8bf6-0296a2b6a120","name":"Read Apple","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[780,240],"credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":1181166958,"mode":"list","cachedResultName":"AMAZON","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=1181166958"},"options":{}},"id":"93fc3c77-6073-4c18-9eaa-bb531051c4e4","name":"Read Amazon","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[780,400],"credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"documentId":{"__rl":true,"value":"1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg","mode":"id"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"GOOGLE","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1O7WqlRcSnwUFvQ72gHU105LrIupvlFdBI5QSCz3J5xg/edit#gid=0"},"options":{}},"id":"58e79ee9-e79c-4d60-a1b6-7f8aa2acc840","name":"Read Nvidia","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[780,560],"credentials":{"googleSheetsOAuth2Api":{"id":"msQv72O0ca6dzU02","name":"Misterh06 (SHEET)"}}},{"parameters":{"jsCode":"// Récupère toutes les lignes du Google Sheets\nconst lignes = items.map(item => item.json);\n\n// Trie les lignes par date croissante (adapte le champ si besoin)\nlignes.sort((a, b) => a.date_cours > b.date_cours ? 1 : -1);\n\n// Prend les 2 dernières (plus récentes)\nconst l1 = lignes[lignes.length-1];\nconst l2 = lignes[lignes.length-2];\n\nif (!l1 || !l2) {\n  return [{ json: { error: \"Pas assez de données\" }}];\n}\n\nconst cours_today = Number(l1.cours_close);\nconst cours_yesterday = Number(l2.cours_close);\nconst variation = ((cours_today - cours_yesterday) / cours_yesterday) * 100;\n\nlet commentaire = \"\";\nif (variation > 1) commentaire = \"📈 Forte hausse\";\nelse if (variation < -1) commentaire = \"📉 Baisse notable\";\nelse commentaire = \"➖ Stable\";\n\nreturn [{\n  json: {\n    date_today: l1.date_cours,\n    cours_today,\n    cours_yesterday,\n    variation: variation.toFixed(2),\n    commentaire\n  }\n}];\n"},"id":"e7ed60ef-5d25-4fd3-8a4b-2fd701f30c76","name":"Préparer Rapport1","type":"n8n-nodes-base.code","typeVersion":1,"position":[980,80]},{"parameters":{"jsCode":"// Récupère toutes les lignes du Google Sheets\nconst lignes = items.map(item => item.json);\n\n// Trie les lignes par date croissante (adapte le champ si besoin)\nlignes.sort((a, b) => a.date_cours > b.date_cours ? 1 : -1);\n\n// Prend les 2 dernières (plus récentes)\nconst l1 = lignes[lignes.length-1];\nconst l2 = lignes[lignes.length-2];\n\nif (!l1 || !l2) {\n  return [{ json: { error: \"Pas assez de données\" }}];\n}\n\nconst cours_today = Number(l1.cours_close);\nconst cours_yesterday = Number(l2.cours_close);\nconst variation = ((cours_today - cours_yesterday) / cours_yesterday) * 100;\n\nlet commentaire = \"\";\nif (variation > 1) commentaire = \"📈 Forte hausse\";\nelse if (variation < -1) commentaire = \"📉 Baisse notable\";\nelse commentaire = \"➖ Stable\";\n\nreturn [{\n  json: {\n    date_today: l1.date_cours,\n    cours_today,\n    cours_yesterday,\n    variation: variation.toFixed(2),\n    commentaire\n  }\n}];\n"},"id":"010f78f8-6c29-4ce0-a05f-85b4f30a9d74","name":"Préparer Rapport2","type":"n8n-nodes-base.code","typeVersion":1,"position":[980,240]},{"parameters":{"jsCode":"// Récupère toutes les lignes du Google Sheets\nconst lignes = items.map(item => item.json);\n\n// Trie les lignes par date croissante (adapte le champ si besoin)\nlignes.sort((a, b) => a.date_cours > b.date_cours ? 1 : -1);\n\n// Prend les 2 dernières (plus récentes)\nconst l1 = lignes[lignes.length-1];\nconst l2 = lignes[lignes.length-2];\n\nif (!l1 || !l2) {\n  return [{ json: { error: \"Pas assez de données\" }}];\n}\n\nconst cours_today = Number(l1.cours_close);\nconst cours_yesterday = Number(l2.cours_close);\nconst variation = ((cours_today - cours_yesterday) / cours_yesterday) * 100;\n\nlet commentaire = \"\";\nif (variation > 1) commentaire = \"📈 Forte hausse\";\nelse if (variation < -1) commentaire = \"📉 Baisse notable\";\nelse commentaire = \"➖ Stable\";\n\nreturn [{\n  json: {\n    date_today: l1.date_cours,\n    cours_today,\n    cours_yesterday,\n    variation: variation.toFixed(2),\n    commentaire\n  }\n}];\n"},"id":"205026e1-d22d-4d26-9a68-7a08fdebd06d","name":"Préparer Rapport3","type":"n8n-nodes-base.code","typeVersion":1,"position":[980,400]},{"parameters":{"jsCode":"// Récupère toutes les lignes du Google Sheets\nconst lignes = items.map(item => item.json);\n\n// Trie les lignes par date croissante (adapte le champ si besoin)\nlignes.sort((a, b) => a.date_cours > b.date_cours ? 1 : -1);\n\n// Prend les 2 dernières (plus récentes)\nconst l1 = lignes[lignes.length-1];\nconst l2 = lignes[lignes.length-2];\n\nif (!l1 || !l2) {\n  return [{ json: { error: \"Pas assez de données\" }}];\n}\n\nconst cours_today = Number(l1.cours_close);\nconst cours_yesterday = Number(l2.cours_close);\nconst variation = ((cours_today - cours_yesterday) / cours_yesterday) * 100;\n\nlet commentaire = \"\";\nif (variation > 1) commentaire = \"📈 Forte hausse\";\nelse if (variation < -1) commentaire = \"📉 Baisse notable\";\nelse commentaire = \"➖ Stable\";\n\nreturn [{\n  json: {\n    date_today: l1.date_cours,\n    cours_today,\n    cours_yesterday,\n    variation: variation.toFixed(2),\n    commentaire\n  }\n}];\n"},"id":"b7571066-2b5a-4e5c-bd5e-682ee3498f3b","name":"Préparer Rapport4","type":"n8n-nodes-base.code","typeVersion":1,"position":[980,560]},{"parameters":{"numberInputs":5},"type":"n8n-nodes-base.merge","typeVersion":3.1,"position":[1280,220],"id":"50b358f9-01f5-4c7d-ac1e-880b838c3474","name":"Merge"},{"parameters":{"jsCode":"// Liste des sociétés dans l'ordre attendu\nconst noms = ['Google', 'Microsoft', 'Apple', 'Amazon', 'Nvidia'];\nlet texte = '';\n\nfor (let i = 0; i < items.length; i++) {\n  const data = items[i].json;\n  let nom = noms[i] || `Titre${i+1}`;\n  if (data.error) {\n    texte += `📝 ${nom} : ${data.error}\\n`;\n  } else {\n    texte += `📝 ${nom} : ${data.cours_today}\\n`;\n    texte += `Variation : ${data.variation} % ${data.commentaire}\\n`;\n  }\n}\nreturn [{ json: { text: texte } }];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1440,260],"id":"4fd84e7a-ed1e-4961-89e4-7052a275b13e","name":"Code5"}],"connections":{"Edit Fields":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]},"Code":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"Read google","type":"main","index":0},{"node":"Read Microsoft","type":"main","index":0},{"node":"Read Apple","type":"main","index":0},{"node":"Read Amazon","type":"main","index":0},{"node":"Read Nvidia","type":"main","index":0}]]},"Préparer Rapport":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Schedule Trigger2":{"main":[[{"node":"Google","type":"main","index":0},{"node":"Microsoft","type":"main","index":0},{"node":"Apple","type":"main","index":0},{"node":"Amazon","type":"main","index":0},{"node":"Nvidia","type":"main","index":0}]]},"Google":{"main":[[{"node":"Code","type":"main","index":0}]]},"Nvidia":{"main":[[{"node":"Code4","type":"main","index":0}]]},"Amazon":{"main":[[{"node":"Code3","type":"main","index":0}]]},"Apple":{"main":[[{"node":"Code2","type":"main","index":0}]]},"Microsoft":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code4":{"main":[[{"node":"Edit Fields4","type":"main","index":0}]]},"Code3":{"main":[[{"node":"Edit Fields3","type":"main","index":0}]]},"Code2":{"main":[[{"node":"Edit Fields2","type":"main","index":0}]]},"Code1":{"main":[[{"node":"Edit Fields1","type":"main","index":0}]]},"Edit Fields1":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Edit Fields2":{"main":[[{"node":"Google Sheets2","type":"main","index":0}]]},"Edit Fields3":{"main":[[{"node":"Google Sheets3","type":"main","index":0}]]},"Edit Fields4":{"main":[[{"node":"Google Sheets4","type":"main","index":0}]]},"Read google":{"main":[[{"node":"Préparer Rapport","type":"main","index":0}]]},"Read Microsoft":{"main":[[{"node":"Préparer Rapport1","type":"main","index":0}]]},"Read Apple":{"main":[[{"node":"Préparer Rapport2","type":"main","index":0}]]},"Read Amazon":{"main":[[{"node":"Préparer Rapport3","type":"main","index":0}]]},"Read Nvidia":{"main":[[{"node":"Préparer Rapport4","type":"main","index":0}]]},"Préparer Rapport1":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Préparer Rapport2":{"main":[[{"node":"Merge","type":"main","index":2}]]},"Préparer Rapport3":{"main":[[{"node":"Merge","type":"main","index":3}]]},"Préparer Rapport4":{"main":[[{"node":"Merge","type":"main","index":4}]]},"Merge":{"main":[[{"node":"Code5","type":"main","index":0}]]},"Code5":{"main":[[{"node":"Telegram - Rapport","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"7af46c04-8742-4c04-8106-a15ca96a996f","triggerCount":2,"tags":[]}